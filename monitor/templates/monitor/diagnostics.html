{% extends 'monitor/base.html' %}

{% block content %}
<div class="max-w-7xl mx-auto">
    <h1 class="text-3xl font-bold text-gray-800 mb-8">üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã</h1>

    <!-- –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ -->
    <div class="bg-white rounded-lg shadow p-6 mb-8">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-semibold">‚ö° –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</h2>
            <button hx-get="/api/diagnostic/quick/" hx-target="#quick-diagnostic"
                    class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
                –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
            </button>
        </div>
        <div id="quick-diagnostic" class="bg-gray-50 rounded p-4 min-h-32">
            <p class="text-gray-500 text-center py-8">–ù–∞–∂–º–∏—Ç–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É" –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–∏—Å—Ç–µ–º—ã</p>
        </div>
    </div>

    <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <!-- –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã -->
        <div class="bg-white rounded-lg shadow p-6">
            <h3 class="text-lg font-semibold mb-4">üíª –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã</h3>
            <div id="system-resources">
                <p class="text-gray-600">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ —Ä–µ—Å—É—Ä—Å–∞—Ö...</p>
            </div>
            <button hx-get="/api/diagnostic/resources/" hx-target="#system-resources"
                    class="mt-4 w-full bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã
            </button>
        </div>

        <!-- –ü—Ä–æ—Ü–µ—Å—Å—ã -->
        <div class="bg-white rounded-lg shadow p-6">
            <h3 class="text-lg font-semibold mb-4">üöÄ –ü—Ä–æ—Ü–µ—Å—Å—ã</h3>
            <div class="space-y-2 mb-4">
                <label class="block text-sm font-medium text-gray-700">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
                <select id="process-sort" class="border border-gray-300 rounded px-3 py-2 w-full">
                    <option value="cpu">–ü–æ CPU</option>
                    <option value="memory">–ü–æ –ø–∞–º—è—Ç–∏</option>
                </select>
            </div>
            <div id="processes-list">
                <p class="text-gray-600">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤...</p>
            </div>
            <button onclick="loadProcesses()"
                    class="mt-4 w-full bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600">
                –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã
            </button>
        </div>
    </div>

    <!-- –°–µ—Ä–≤–∏—Å—ã –∏ —Å–µ—Ç—å -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã -->
        <div class="bg-white rounded-lg shadow p-6">
            <h3 class="text-lg font-semibold mb-4">üîß –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã</h3>
            <div id="services-list">
                <p class="text-gray-600">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤...</p>
            </div>
            <button hx-get="/api/diagnostic/services/" hx-target="#services-list"
                    class="mt-4 w-full bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600">
                –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
            </button>
        </div>

        <!-- –°–µ—Ç–µ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div class="bg-white rounded-lg shadow p-6">
            <h3 class="text-lg font-semibold mb-4">üåê –°–µ—Ç–µ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <div id="network-info">
                <p class="text-gray-600">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...</p>
            </div>
            <button hx-get="/api/diagnostic/network/" hx-target="#network-info"
                    class="mt-4 w-full bg-indigo-500 text-white px-4 py-2 rounded hover:bg-indigo-600">
                –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ç—å
            </button>
        </div>
    </div>
</div>

<script>
function loadProcesses() {
    const sortBy = document.getElementById('process-sort').value;
    htmx.ajax('GET', `/api/diagnostic/processes/?sort_by=${sortBy}&limit=10`, {
        target: '#processes-list'
    });
}

document.addEventListener('DOMContentLoaded', function() {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    loadProcesses();
    htmx.ajax('GET', '/api/diagnostic/services/', { target: '#services-list' });
});
</script>
{% endblock %}