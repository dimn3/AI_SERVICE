{% extends 'monitor/pretty_base.html' %}

{% block title %}–°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã - AI Monitor{% endblock %}

{% block content %}
<div class="mb-6">
    <h2 class="text-2xl font-bold text-gray-800 mb-2">‚öôÔ∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã</h2>
    <p class="text-gray-600">
        –í—Å–µ–≥–æ —Å–µ—Ä–≤–∏—Å–æ–≤: {{ total_count }},
        –∑–∞–ø—É—â–µ–Ω–æ: {{ running_count }},
        —Å –æ—à–∏–±–∫–∞–º–∏: {{ failed_count }}
    </p>
</div>

{% if not ssh_service.connected %}
<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
    <div class="flex items-center">
        <i class="fas fa-exclamation-triangle text-yellow-500 mr-3"></i>
        <div>
            <h3 class="font-semibold text-yellow-800">SSH –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</h3>
            <p class="text-yellow-700 text-sm">–î–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏</p>
        </div>
    </div>
</div>
{% endif %}

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
    <div class="bg-white rounded-lg shadow-sm border p-4 text-center">
        <div class="text-2xl font-bold text-blue-600">{{ total_count }}</div>
        <div class="text-sm text-blue-700">–í—Å–µ–≥–æ</div>
    </div>
    <div class="bg-white rounded-lg shadow-sm border p-4 text-center">
        <div class="text-2xl font-bold text-green-600">{{ running_count }}</div>
        <div class="text-sm text-green-700">–ó–∞–ø—É—â–µ–Ω–æ</div>
    </div>
    <div class="bg-white rounded-lg shadow-sm border p-4 text-center">
        <div class="text-2xl font-bold text-red-600">{{ failed_count }}</div>
        <div class="text-sm text-red-700">–° –æ—à–∏–±–∫–∞–º–∏</div>
    </div>
    <div class="bg-white rounded-lg shadow-sm border p-4 text-center">
        <div class="text-2xl font-bold text-purple-600">
            {% if total_count > 0 %}
                {% widthratio running_count total_count 100 %}%
            {% else %}
                0%
            {% endif %}
        </div>
        <div class="text-sm text-purple-700">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</div>
    </div>
</div>



<!-- –¢–∞–±–ª–∏—Ü–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ -->
<div class="bg-white rounded-xl shadow-sm border overflow-hidden">
    <div class="overflow-x-auto">
        <table class="w-full text-sm text-left text-gray-700">
            <thead class="bg-gray-100">
                <tr>
                    <th class="px-4 py-3 font-semibold">–°–µ—Ä–≤–∏—Å</th>
                    <th class="px-4 py-3 font-semibold">–°—Ç–∞—Ç—É—Å</th>
                    <th class="px-4 py-3 font-semibold">–û–ø–∏—Å–∞–Ω–∏–µ</th>
                </tr>
            </thead>
            <tbody>
                {% for service in services %}
                <tr class="border-b hover:bg-gray-50">
                    <td class="px-4 py-3 font-medium">
                        <div class="flex items-center space-x-2">
                            {% if service.status == 'running' %}
                                <i class="fas fa-play text-green-500"></i>
                            {% elif service.status == 'failed' %}
                                <i class="fas fa-exclamation-triangle text-red-500"></i>
                            {% else %}
                                <i class="fas fa-stop text-gray-400"></i>
                            {% endif %}
                            <span>{{ service.name|default:"N/A" }}</span>
                        </div>
                    </td>
                    <td class="px-4 py-3">
                        <span class="px-2 py-1 rounded text-xs font-medium
                            {% if service.status == 'running' %}bg-green-100 text-green-800
                            {% elif service.status == 'failed' %}bg-red-100 text-red-800
                            {% else %}bg-gray-100 text-gray-800{% endif %}">
                            {% if service.status == 'running' %}–ó–∞–ø—É—â–µ–Ω
                            {% elif service.status == 'failed' %}–û—à–∏–±–∫–∞
                            {% else %}–û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω{% endif %}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-gray-600">
                        {{ service.description|default:"–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è" }}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="3" class="px-4 py-8 text-center text-gray-500">
                        <i class="fas fa-inbox text-3xl mb-2 text-gray-300"></i>
                        <p>–°–µ—Ä–≤–∏—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- –î–µ–π—Å—Ç–≤–∏—è -->
<div class="mt-6 bg-white rounded-xl shadow-sm p-6 border">
    <h3 class="text-lg font-semibold mb-4">‚ö° –î–µ–π—Å—Ç–≤–∏—è</h3>
    <div class="flex flex-wrap gap-4">
        <button onclick="location.reload()"
                class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">
            üîÑ –û–±–Ω–æ–≤–∏—Ç—å
        </button>
        <button onclick="window.location.href='/ai-chat/'"
                class="bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors">
            ü§ñ AI –ê–Ω–∞–ª–∏–∑ —Å–µ—Ä–≤–∏—Å–æ–≤
        </button>
    </div>
</div>
{% endblock %}